# mongoose

Mongoose, сторонняя библиотека на основе Node.js для MongoDB, может помочь легко структурировать данные и получать к ним доступ.
Проблема, которую Mongoose стремится решить, заключается в том, чтобы позволить разработчикам принудительно применять определенную схему на уровне приложения.

Mongoose помогает делать некоторые задачи легкими:
 - моделированием данных, 
 - применением схем, 
 - проверкой моделей, 
 - общая обработкой данных.

 По умолчанию MongoDB имеет гибкую модель данных, что позволяет легко изменять базы данных и обновлять их.

 Что такое схема?
Схема определяет структуру документов коллекции. 
С помощью схемы  определяется  каждое поле и его тип данных.
Допустимые типы:

String
Number
Date
Buffer
Boolean
Mixed
ObjectId
Array
Decimal128
Map

Что такое модель?
Модели берут вашу схему и применяют ее к каждому документу в своей коллекции.
Модели отвечают за все взаимодействия с документами, такие как создание, чтение, обновление и удаление (CRUD).

Преимущество использования Mongoose в том, что у нас есть схема для работы в коде нашего приложения и явная связь между нашими документами MongoDB и моделями Mongoose в  приложении.

Недостаток: 
- мы можем создавать только записи , и они должны следовать определенной схеме. 
- связь между схемой и моделью существует только в пределах приложения Node.js. База данных MongoDB не знает об этой связи, она просто вставляет или извлекает запрашиваемые данные без какой-либо проверки. В случае, если используется другой язык программирования для взаимодействия с базой данных, все ограничения и модели, которые определили в Mongoose, будут бесполезны.

Сама база не имеет возможности проверять данные, но это можно делать на уровне приложения Компас.


1. Настройка среды

npm init -y
npm i mongoose
npm i -D nodemon

2. Давайте добавим скрипт в package.jsonфайл для запуска проекта. 
"scripts": {
    "dev": "nodemon index.js"
  },

3. Использую ES Modules и добавляю в скрипт вместо Common JS:
"type": "module"

Подключение к MongoDB

4. в index.js создаю подключение к базе.

5. npm install dotenv => .env

6. Создание схемы и модели в Blog.js

7. работа с методом save() , create()

| Характеристика               | `Model.create()`              | `new Model() + .save()`               |
| ---------------------------- | ----------------------------- | ------------------------------------- |
| Создание и сохранение        | Одновременно                  | Поэтапно                              |
| Возврат                      | Объект (или массив)           | Объект                                |
| Поддержка хуков (middleware) | ✅ (`pre`, `post` save/create) | ✅                                     |
| Удобно для                   | Быстрого добавления данных    | Детальной настройки перед сохранением |

8. Агрегация — это способ обрабатывать и анализировать данные в базе MongoDB.
Она позволяет делать сложные запросы, объединять, фильтровать, группировать, сортировать и изменять данные прямо на сервере.

9. Индексы - специальная структура данных , позволяющая быстро находить необходимые данные.